# Windowså®‰å…¨åˆè§„æŒ‡å—

## Q4: å¦‚ä½•é¿å…è¢«Windowså®‰å…¨ç¨‹åºè¯¯åˆ¤ä¸ºæ¶æ„è¡Œä¸ºï¼Ÿ

---

## 1. é—®é¢˜åˆ†æ

### 1.1 ä¸ºä»€ä¹ˆHEMouseä¼šè¢«è¯¯åˆ¤ï¼Ÿ

HEMouseçš„æ ¸å¿ƒåŠŸèƒ½ä¸æ¶æ„è½¯ä»¶çš„å…¸å‹è¡Œä¸ºé«˜åº¦é‡åˆï¼š

| HEMouseåŠŸèƒ½ | æ¶æ„è½¯ä»¶ç›¸ä¼¼è¡Œä¸º | é£é™©ç­‰çº§ |
|------------|----------------|---------|
| **å…¨å±€é”®ç›˜é’©å­** | é”®ç›˜è®°å½•å™¨ï¼ˆKeyloggerï¼‰ | ğŸ”´ HIGH |
| **é”®ç›˜è¾“å…¥æ‹¦æˆª** | çªƒå–å¯†ç ã€ä¿¡ç”¨å¡ä¿¡æ¯ | ğŸ”´ HIGH |
| **é®ç½©å±‚çª—å£** | ç½‘ç»œé’“é±¼ï¼ˆå‡å†’ç™»å½•ç•Œé¢ï¼‰ | ğŸŸ¡ MEDIUM |
| **UIè‡ªåŠ¨åŒ–ï¼ˆUIAï¼‰** | ç‚¹å‡»åŠ«æŒã€è‡ªåŠ¨åŒ–æ”»å‡» | ğŸŸ¡ MEDIUM |
| **å¼€æœºè‡ªå¯åŠ¨** | æŒä¹…åŒ–é©»ç•™ | ğŸŸ¡ MEDIUM |
| **DLLæ³¨å…¥ï¼ˆå¦‚æœä½¿ç”¨ï¼‰** | è¿›ç¨‹åŠ«æŒã€ä»£ç æ³¨å…¥ | ğŸ”´ HIGH |

### 1.2 å…¸å‹è¯¯æŠ¥åœºæ™¯

**åœºæ™¯1ï¼šWindows Defenderè¯¯æŠ¥**
```
å¨èƒåç§°: Trojan:Win32/Wacatac.B!ml
æ£€æµ‹åˆ°çš„æ–‡ä»¶: hemouse.exe
é£é™©: é«˜
è¡Œä¸º: å…¨å±€é”®ç›˜é’©å­ + é”®ç›˜è¾“å…¥æ‹¦æˆª
```

**åœºæ™¯2ï¼šç¬¬ä¸‰æ–¹æ€æ¯’è½¯ä»¶ï¼ˆå¦‚å¡å·´æ–¯åŸºã€è¯ºé¡¿ï¼‰**
```
å¨èƒç±»å‹: Potentially Unwanted Program (PUP)
åŸå› : æœªç­¾åçš„å¯æ‰§è¡Œæ–‡ä»¶ä½¿ç”¨æ•æ„ŸAPI
å»ºè®®: éš”ç¦»æˆ–åˆ é™¤
```

**åœºæ™¯3ï¼šä¼ä¸šé˜²æŠ¤è½¯ä»¶ï¼ˆå¦‚CrowdStrikeã€Carbon Blackï¼‰**
```
è¡Œä¸ºæ£€æµ‹: å¼‚å¸¸è¿›ç¨‹è¡Œä¸º
- å…¨å±€é’©å­å®‰è£…
- é”®ç›˜è¾“å…¥ç›‘æ§
- è·¨è¿›ç¨‹çª—å£æ“ä½œ
åŠ¨ä½œ: é˜»æ­¢æ‰§è¡Œ + ä¸ŠæŠ¥å®‰å…¨å›¢é˜Ÿ
```

### 1.3 å½±å“èŒƒå›´

- **ç”¨æˆ·ä½“éªŒ**ï¼šå®‰è£…å¤±è´¥ã€ç¨‹åºæ— æ³•å¯åŠ¨
- **ä¿¡ä»»åº¦**ï¼šç”¨æˆ·æ€€ç–‘è½¯ä»¶å®‰å…¨æ€§
- **å¸‚åœºæ¨å¹¿**ï¼šä¸‹è½½é‡é™ä½ã€è´Ÿé¢è¯„ä»·
- **ä¼ä¸šéƒ¨ç½²**ï¼šITéƒ¨é—¨æ‹’ç»æ‰¹å‡†å®‰è£…

---

## 2. å®‰å…¨åˆè§„ç­–ç•¥çŸ©é˜µ

### 2.1 åˆè§„å±‚çº§ï¼ˆ4å±‚é˜²å¾¡ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 4: è¡Œä¸ºé€æ˜åŒ–ï¼ˆè¿è¡Œæ—¶ä¿¡ä»»ï¼‰                        â”‚
â”‚ - ç”¨æˆ·æˆæƒæç¤º                                           â”‚
â”‚ - å®æ—¶è¡Œä¸ºæ—¥å¿—                                           â”‚
â”‚ - éšç§å£°æ˜                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 3: å®‰å…¨å‚å•†ç™½åå•ï¼ˆç¬¬ä¸‰æ–¹è®¤è¯ï¼‰                    â”‚
â”‚ - å‘æ€æ¯’è½¯ä»¶å‚å•†ç”³è¯·ç™½åå•                               â”‚
â”‚ - æäº¤VirusTotalæ‰«ææŠ¥å‘Š                                â”‚
â”‚ - Microsoft SmartScreenä¿¡èª‰ç´¯ç§¯                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 2: ä»£ç ç­¾åï¼ˆèº«ä»½è®¤è¯ï¼‰                            â”‚
â”‚ - EVä»£ç ç­¾åè¯ä¹¦                                         â”‚
â”‚ - æ—¶é—´æˆ³ç­¾å                                             â”‚
â”‚ - ç­¾åéªŒè¯è‡ªåŠ¨åŒ–                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 1: ä»£ç å®ç°å®‰å…¨ï¼ˆæŠ€æœ¯åŸºç¡€ï¼‰                        â”‚
â”‚ - æœ€å°æƒé™åŸåˆ™                                           â”‚
â”‚ - å®‰å…¨APIé€‰æ‹©                                            â”‚
â”‚ - æ²™ç®±éš”ç¦»                                               â”‚
â”‚ - å¼€æºé€æ˜                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. Layer 1: ä»£ç å®ç°å®‰å…¨

### 3.1 æœ€å°æƒé™åŸåˆ™

**åŸåˆ™**ï¼šåªè¯·æ±‚å¿…è¦çš„æƒé™ï¼Œé¿å…è¿‡åº¦æƒé™

#### æƒé™éœ€æ±‚åˆ†æ

| åŠŸèƒ½ | éœ€è¦æƒé™ | é£é™©è¯„ä¼° | æ›¿ä»£æ–¹æ¡ˆ |
|-----|---------|---------|---------|
| é”®ç›˜é’©å­ | ç”¨æˆ·çº§é’©å­ | ä¸­ | âœ… ä½¿ç”¨`WH_KEYBOARD_LL`ï¼ˆç”¨æˆ·çº§ï¼‰<br>âŒ é¿å…å†…æ ¸é©±åŠ¨ |
| UIå…ƒç´ æ£€æµ‹ | UIAè®¿é—®æƒé™ | ä½ | âœ… ä½¿ç”¨Windows UIA API<br>âŒ é¿å…è¿›ç¨‹æ³¨å…¥ |
| é®ç½©çª—å£ | æ— ç‰¹æ®Šæƒé™ | ä½ | âœ… æ ‡å‡†çª—å£API |
| å¼€æœºè‡ªå¯åŠ¨ | æ³¨å†Œè¡¨å†™å…¥ | ä¸­ | âœ… ç”¨æˆ·æ‰¹å‡†åå†™å…¥<br>âŒ é¿å…æœåŠ¡å®‰è£… |

#### ä¸éœ€è¦ç®¡ç†å‘˜æƒé™

```python
# âœ… å¥½çš„å®è·µï¼šç”¨æˆ·çº§é’©å­ï¼Œä¸éœ€è¦ç®¡ç†å‘˜æƒé™
def install_user_level_hook():
    """ç”¨æˆ·çº§é”®ç›˜é’©å­"""
    hook_handle = ctypes.windll.user32.SetWindowsHookExW(
        13,  # WH_KEYBOARD_LLï¼ˆç”¨æˆ·çº§ï¼‰
        callback,
        None,
        0
    )
    return hook_handle

# âŒ åçš„å®è·µï¼šè¦æ±‚ç®¡ç†å‘˜æƒé™
def install_kernel_driver():
    """å†…æ ¸é©±åŠ¨ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰"""
    # è¿™ä¼šè§¦å‘UACæç¤ºï¼Œä¸”è¢«æ€æ¯’è½¯ä»¶é«˜åº¦è­¦æƒ•
    service_handle = win32service.CreateService(...)
```

### 3.2 å®‰å…¨APIé€‰æ‹©

#### é”®ç›˜é’©å­ï¼šé€‰æ‹©ç”¨æˆ·çº§è€Œéå†…æ ¸çº§

```cpp
// âœ… æ¨èï¼šç”¨æˆ·çº§åº•å±‚é’©å­ï¼ˆWH_KEYBOARD_LLï¼‰
HHOOK hook = SetWindowsHookEx(
    WH_KEYBOARD_LL,  // ç”¨æˆ·æ¨¡å¼ï¼Œä½é£é™©
    KeyboardProc,
    hInstance,
    0  // å…¨å±€é’©å­ï¼Œä½†ä»åœ¨ç”¨æˆ·ç©ºé—´
);

// âŒ é¿å…ï¼šå†…æ ¸é©±åŠ¨è¿‡æ»¤
// éœ€è¦ç­¾åã€ç®¡ç†å‘˜æƒé™ã€æé«˜é£é™©
NTSTATUS status = IoCreateDevice(...);
```

#### UIè‡ªåŠ¨åŒ–ï¼šä½¿ç”¨å®˜æ–¹UIAè€Œéæ³¨å…¥

```python
# âœ… æ¨èï¼šWindows UIA APIï¼ˆå®˜æ–¹æ”¯æŒï¼‰
from pywinauto import Desktop
desktop = Desktop(backend="uia")
elements = desktop.windows()

# âŒ é¿å…ï¼šDLLæ³¨å…¥
# æé«˜é£é™©ï¼Œæ€æ¯’è½¯ä»¶å¿…å®šæ‹¦æˆª
def inject_dll(target_pid, dll_path):
    # ä¸è¦ä½¿ç”¨è¿™ç§æ–¹æ³•ï¼
    pass
```

### 3.3 æ•°æ®éšç§ä¿æŠ¤

#### ä¸å­˜å‚¨æ•æ„Ÿæ•°æ®

```python
class KeyboardInputHandler:
    def __init__(self):
        # âŒ é¿å…ï¼šè®°å½•æ‰€æœ‰é”®ç›˜è¾“å…¥
        self.input_history = []

    def on_key_press(self, key):
        # âœ… æ¨èï¼šåªå¤„ç†æ ‡ç­¾é”®ï¼Œç«‹å³ä¸¢å¼ƒ
        if self.is_label_key(key):
            self.handle_label_selection(key)
            # ä¸è®°å½•åˆ°æ—¥å¿—æˆ–æ–‡ä»¶
        else:
            # å¿½ç•¥éæ ‡ç­¾é”®
            pass

    # âŒ é¿å…ï¼šæŒä¹…åŒ–é”®ç›˜è¾“å…¥
    def save_logs(self):
        with open("keylog.txt", "w") as f:
            f.write(str(self.input_history))
```

#### ç½‘ç»œé€šä¿¡é€æ˜åŒ–

```python
# âœ… æ¨èï¼šæ— ç½‘ç»œé€šä¿¡ï¼ˆé™¤éå¿…è¦ï¼‰
# HEMouseä¸éœ€è¦è”ç½‘ï¼Œé¿å…ä»»ä½•ç½‘ç»œè¯·æ±‚

# å¦‚æœå¿…é¡»è”ç½‘ï¼ˆå¦‚æ›´æ–°æ£€æŸ¥ï¼‰ï¼š
def check_for_updates():
    """é€æ˜çš„æ›´æ–°æ£€æŸ¥"""
    # 1. æå‰å‘ŠçŸ¥ç”¨æˆ·
    if not user_consent_for_update_check():
        return

    # 2. ä½¿ç”¨HTTPS
    response = requests.get(
        "https://hemouse.example.com/version.json",
        timeout=5
    )

    # 3. è®°å½•æ—¥å¿—
    logger.info(f"Update check: {response.status_code}")

    # 4. ä¸å‘é€ä»»ä½•ç”¨æˆ·æ•°æ®
    # âŒ é¿å…ï¼šå‘é€ç”¨æˆ·IDã€ç³»ç»Ÿä¿¡æ¯ã€ä½¿ç”¨ç»Ÿè®¡
```

### 3.4 ä»£ç æ··æ·† vs å¼€æºé€æ˜

**é€‰æ‹©ï¼šå¼€æºé€æ˜ï¼ˆæ¨èï¼‰**

| ç­–ç•¥ | ä¼˜ç‚¹ | ç¼ºç‚¹ | æ¨èåº¦ |
|-----|------|------|-------|
| **å¼€æºï¼ˆGitHubå…¬å¼€ï¼‰** | - å¯å®¡è®¡æ€§<br>- ç¤¾åŒºä¿¡ä»»<br>- æ€æ¯’è½¯ä»¶æ˜“éªŒè¯ | - æ— å•†ä¸šç§˜å¯†ä¿æŠ¤ | â­â­â­â­â­ |
| **ä»£ç æ··æ·†** | - ä¿æŠ¤çŸ¥è¯†äº§æƒ | - å¢åŠ å¯ç–‘åº¦<br>- æ€æ¯’è½¯ä»¶è¯¯æŠ¥ç‡â†‘ | â­â­ |
| **é—­æºäºŒè¿›åˆ¶** | - å®Œå…¨ä¿å¯† | - ä¿¡ä»»åº¦â†“<br>- è¯¯æŠ¥ç‡æœ€é«˜ | â­ |

**å¼€æºç­–ç•¥**ï¼š
```yaml
ä»“åº“ç»“æ„:
  hemouse/
    src/              # å®Œæ•´æºä»£ç 
    docs/             # æ–‡æ¡£
    tests/            # å•å…ƒæµ‹è¯•
    SECURITY.md       # å®‰å…¨å£°æ˜
    PRIVACY.md        # éšç§æ”¿ç­–
    CODE_OF_CONDUCT.md

è®¸å¯è¯: MITæˆ–Apache 2.0ï¼ˆå®½æ¾å¼€æºï¼‰

å®‰å…¨å£°æ˜ç¤ºä¾‹:
  - ä¸æ”¶é›†ç”¨æˆ·æ•°æ®
  - ä¸è”ç½‘ï¼ˆé™¤æ›´æ–°æ£€æŸ¥ï¼‰
  - é”®ç›˜è¾“å…¥ä»…æœ¬åœ°å¤„ç†
  - å¯å®¡è®¡çš„ä»£ç 
```

---

## 4. Layer 2: ä»£ç ç­¾åï¼ˆèº«ä»½è®¤è¯ï¼‰

### 4.1 ä¸ºä»€ä¹ˆéœ€è¦ä»£ç ç­¾åï¼Ÿ

**Windows SmartScreenæœºåˆ¶**ï¼š
```
æœªç­¾åç¨‹åº â†’ "Windowså·²ä¿æŠ¤ä½ çš„ç”µè„‘"è­¦å‘Š â†’ ç”¨æˆ·æ”¾å¼ƒå®‰è£…ï¼ˆ70%+ï¼‰
å·²ç­¾åç¨‹åº â†’ éªŒè¯å‘å¸ƒè€…èº«ä»½ â†’ é™ä½æ‹¦æˆªç‡ï¼ˆå‡å°‘90%+è¯¯æŠ¥ï¼‰
```

### 4.2 EVä»£ç ç­¾åè¯ä¹¦ï¼ˆå¼ºçƒˆæ¨èï¼‰

#### è¯ä¹¦ç±»å‹å¯¹æ¯”

| è¯ä¹¦ç±»å‹ | éªŒè¯çº§åˆ« | ä¿¡èª‰ç´¯ç§¯ | SmartScreenæ•ˆæœ | ä»·æ ¼ | æ¨èåº¦ |
|---------|---------|---------|----------------|------|-------|
| **EVä»£ç ç­¾å** | ä¼ä¸šèº«ä»½éªŒè¯ | ç«‹å³ä¿¡èª‰ | æ— è­¦å‘Š | $300-500/å¹´ | â­â­â­â­â­ |
| **æ ‡å‡†ä»£ç ç­¾å** | åŸºç¡€èº«ä»½éªŒè¯ | éœ€ç´¯ç§¯ | åˆæœŸæœ‰è­¦å‘Š | $100-200/å¹´ | â­â­â­ |
| **è‡ªç­¾åè¯ä¹¦** | æ— éªŒè¯ | æ— ä¿¡èª‰ | ä¸¥é‡è­¦å‘Š | å…è´¹ | â­ |

#### EVè¯ä¹¦ä¼˜åŠ¿

**ç«‹å³ä¿¡èª‰**ï¼š
- é¦–æ¬¡å‘å¸ƒå³å¯ç»•è¿‡SmartScreenè­¦å‘Š
- æ˜¾ç¤ºå®Œæ•´ä¼ä¸šåç§°ï¼ˆå¦‚"Manshall Technology Co."ï¼‰
- æ€æ¯’è½¯ä»¶ç™½åå•ç”³è¯·æ›´æ˜“é€šè¿‡

**ç¡¬ä»¶ä¿æŠ¤**ï¼š
- ç§é’¥å­˜å‚¨åœ¨USBç¡¬ä»¶ä»¤ç‰Œä¸­ï¼Œæ— æ³•è¢«ç›—
- é˜²æ­¢è¯ä¹¦æ»¥ç”¨å’ŒåŠé”€é£é™©

### 4.3 è·å–EVè¯ä¹¦æ­¥éª¤

#### æ¨èä¾›åº”å•†

| ä¾›åº”å•† | ä»·æ ¼ | éªŒè¯å‘¨æœŸ | æ”¯æŒ |
|-------|------|---------|------|
| **DigiCert** | $474/å¹´ | 3-5å·¥ä½œæ—¥ | â­â­â­â­â­ |
| **Sectigo (Comodo)** | $299/å¹´ | 5-7å·¥ä½œæ—¥ | â­â­â­â­ |
| **GlobalSign** | $399/å¹´ | 3-5å·¥ä½œæ—¥ | â­â­â­â­ |

#### ç”³è¯·æµç¨‹

**1. ä¼ä¸šèº«ä»½å‡†å¤‡**ï¼ˆ1-2å¤©ï¼‰
```yaml
å¿…éœ€ææ–™:
  - è¥ä¸šæ‰§ç…§å‰¯æœ¬
  - ä¼ä¸šé“¶è¡Œè´¦æˆ·è¯æ˜
  - æ³•äººèº«ä»½è¯
  - ä¼ä¸šé‚®ç®±ï¼ˆ@company.comï¼‰
  - ä¼ä¸šç”µè¯ï¼ˆå¯éªŒè¯ï¼‰

æ³¨æ„:
  - ä¸ªäººå¼€å‘è€…éœ€æ³¨å†Œä¸ªä½“å·¥å•†æˆ·æˆ–å…¬å¸
  - åœ°å€å¿…é¡»ä¸å·¥å•†æ³¨å†Œåœ°å€ä¸€è‡´
```

**2. åœ¨çº¿ç”³è¯·**ï¼ˆ1å¤©ï¼‰
```
1. è®¿é—®DigiCertå®˜ç½‘ â†’ Code Signing â†’ EV Code Signing Certificate
2. å¡«å†™ä¼ä¸šä¿¡æ¯ï¼ˆè‹±æ–‡ï¼‰
3. ä¸Šä¼ ä¼ä¸šæ–‡ä»¶
4. æ”¯ä»˜$474ï¼ˆæ”¯æŒä¿¡ç”¨å¡/PayPalï¼‰
```

**3. èº«ä»½éªŒè¯**ï¼ˆ3-5å¤©ï¼‰
```
DigiCertä¼šé€šè¿‡ä»¥ä¸‹æ–¹å¼éªŒè¯ï¼š
- é‚“ç™½æ°ç¼–ç ï¼ˆDUNSï¼‰æŸ¥è¯¢ï¼ˆè‡ªåŠ¨ï¼‰
- ç”µè¯å›è®¿ï¼ˆéªŒè¯ä¼ä¸šå­˜åœ¨ï¼‰
- ä¼ä¸šé‚®ç®±ç¡®è®¤ï¼ˆéªŒè¯å‘˜å·¥èº«ä»½ï¼‰
- é“¶è¡Œè´¦æˆ·éªŒè¯ï¼ˆå¯é€‰ï¼‰
```

**4. æ”¶åˆ°USBä»¤ç‰Œ**ï¼ˆ5-7å¤©ç‰©æµï¼‰
```
DigiCertå¯„é€SafeNet USBä»¤ç‰Œï¼š
- åŒ…å«ç§é’¥çš„ç¡¬ä»¶è®¾å¤‡
- éœ€è¦è®¾ç½®PINç 
- æ’å…¥ç”µè„‘åæ‰èƒ½ç­¾å
```

### 4.4 ç­¾åå®è·µ

#### Windowså¯æ‰§è¡Œæ–‡ä»¶ç­¾å

```bash
# ä½¿ç”¨signtoolï¼ˆWindows SDKè‡ªå¸¦ï¼‰
signtool sign ^
  /f "certificate.pfx" ^            # è¯ä¹¦æ–‡ä»¶ï¼ˆå¦‚æœä½¿ç”¨è½¯ä»¶è¯ä¹¦ï¼‰
  /p "password" ^                    # è¯ä¹¦å¯†ç 
  /fd SHA256 ^                       # ä½¿ç”¨SHA256å“ˆå¸Œ
  /tr http://timestamp.digicert.com ^  # æ—¶é—´æˆ³æœåŠ¡å™¨
  /td SHA256 ^                       # æ—¶é—´æˆ³å“ˆå¸Œç®—æ³•
  /v ^                               # è¯¦ç»†è¾“å‡º
  hemouse.exe

# å¦‚æœä½¿ç”¨EVè¯ä¹¦çš„USBä»¤ç‰Œï¼š
signtool sign ^
  /n "Your Company Name" ^           # è¯ä¹¦ä¸»é¢˜åç§°
  /fd SHA256 ^
  /tr http://timestamp.digicert.com ^
  /td SHA256 ^
  /v ^
  hemouse.exe
```

#### Pythonæ‰“åŒ…ç­¾åï¼ˆPyInstallerï¼‰

```python
# build_and_sign.py
import subprocess
import os

def build_executable():
    """ä½¿ç”¨PyInstalleræ‰“åŒ…"""
    subprocess.run([
        "pyinstaller",
        "--onefile",
        "--windowed",
        "--icon=hemouse.ico",
        "--name=HEMouse",
        "main.py"
    ], check=True)

def sign_executable(exe_path):
    """ç­¾åå¯æ‰§è¡Œæ–‡ä»¶"""
    subprocess.run([
        "signtool", "sign",
        "/n", "Manshall Technology Co.",  # ä½ çš„å…¬å¸å
        "/fd", "SHA256",
        "/tr", "http://timestamp.digicert.com",
        "/td", "SHA256",
        "/v",
        exe_path
    ], check=True)

if __name__ == "__main__":
    build_executable()
    sign_executable("dist/HEMouse.exe")
    print("âœ… Build and sign completed")
```

#### DLLç­¾åï¼ˆC++æ ¸å¿ƒæ¨¡å—ï¼‰

```bash
# ç­¾åhemouse_core.dll
signtool sign ^
  /n "Your Company Name" ^
  /fd SHA256 ^
  /tr http://timestamp.digicert.com ^
  /td SHA256 ^
  hemouse_core.dll

# éªŒè¯ç­¾å
signtool verify /pa hemouse_core.dll
```

### 4.5 æ—¶é—´æˆ³é‡è¦æ€§

**æ²¡æœ‰æ—¶é—´æˆ³çš„åæœ**ï¼š
- è¯ä¹¦è¿‡æœŸåï¼Œç­¾åå¤±æ•ˆ
- ç”¨æˆ·ä¸‹è½½æ—§ç‰ˆæœ¬æ—¶ä¼šæŠ¥é”™

**ä½¿ç”¨æ—¶é—´æˆ³**ï¼š
- è¯æ˜"ç­¾åæ—¶è¯ä¹¦æœ‰æ•ˆ"
- è¯ä¹¦è¿‡æœŸåï¼Œæ—§ç‰ˆæœ¬ä»å¯ä¿¡ä»»

```bash
# âœ… å¥½çš„å®è·µï¼šæ·»åŠ æ—¶é—´æˆ³
signtool sign /tr http://timestamp.digicert.com /td SHA256 hemouse.exe

# âŒ åçš„å®è·µï¼šä¸æ·»åŠ æ—¶é—´æˆ³
signtool sign hemouse.exe  # è¯ä¹¦è¿‡æœŸåç­¾åå¤±æ•ˆ
```

---

## 5. Layer 3: å®‰å…¨å‚å•†ç™½åå•

### 5.1 Microsoft Defenderæäº¤

#### è¯¯æŠ¥ç”³è¯‰æµç¨‹

**1. æäº¤åˆ°Microsoft Security Intelligence**
```
ç½‘å€: https://www.microsoft.com/wdsi/filesubmission

æ­¥éª¤:
1. é€‰æ‹©"Software developer" â†’ "Submit suspected false positive"
2. ä¸Šä¼ hemouse.exe
3. å¡«å†™è¡¨å•:
   - File name: HEMouse.exe
   - SHA256: [è®¡ç®—æ–‡ä»¶å“ˆå¸Œ]
   - Software name: HEMouse
   - Contact email: your@email.com
4. è¯¦ç»†è¯´æ˜:
   "HEMouse is a legitimate accessibility tool that uses keyboard hooks
    for hands-free mouse control. It does not collect user data or
    connect to the internet. Source code available at github.com/..."
```

**2. ç­‰å¾…äººå·¥å®¡æ ¸**ï¼ˆ1-3ä¸ªå·¥ä½œæ—¥ï¼‰
```
å®¡æ ¸ç»“æœ:
- âœ… é€šè¿‡: æ–‡ä»¶ä»å¨èƒå®šä¹‰ä¸­ç§»é™¤ï¼Œå…¨çƒç”Ÿæ•ˆ
- âŒ æ‹’ç»: éœ€è¦ä¿®æ”¹ä»£ç æˆ–æä¾›æ›´å¤šè¯æ˜
```

#### é¢„é˜²æ€§æäº¤ï¼ˆæ¨èï¼‰

```
åœ¨å‘å¸ƒå‰æäº¤:
- é¿å…ç”¨æˆ·é‡åˆ°è¯¯æŠ¥
- ç´¯ç§¯SmartScreenä¿¡èª‰
- å»ºç«‹ä¸Microsoftçš„ä¿¡ä»»å…³ç³»

æäº¤æ—¶æœº:
- æ¯ä¸ªæ–°ç‰ˆæœ¬å‘å¸ƒå‰7å¤©æäº¤
- ä¸»ç‰ˆæœ¬æ›´æ–°å¿…é¡»æäº¤
- ä»£ç ç­¾åè¯ä¹¦æ›´æ¢åé‡æ–°æäº¤
```

### 5.2 ç¬¬ä¸‰æ–¹æ€æ¯’è½¯ä»¶ç™½åå•

#### ä¸»æµæ€æ¯’è½¯ä»¶ç”³è¯‰æ¸ é“

| æ€æ¯’è½¯ä»¶ | è¯¯æŠ¥ç”³è¯‰ç½‘å€ | å®¡æ ¸å‘¨æœŸ | å¤‡æ³¨ |
|---------|------------|---------|------|
| **Kaspersky** | https://opentip.kaspersky.com/ | 1-2å¤© | éœ€è¦ä¿„è¯­æˆ–è‹±è¯­ |
| **Norton (Symantec)** | https://submit.norton.com/ | 2-3å¤© | è¯¦ç»†è¯´æ˜å¿…éœ€ |
| **McAfee** | https://www.mcafee.com/enterprise/en-us/threat-center/submit-sample.html | 3-5å¤© | ä¼ä¸šç”¨æˆ·ä¼˜å…ˆ |
| **Avast/AVG** | https://www.avast.com/false-positive-file-form.php | 1-2å¤© | éœ€è¦ä¸Šä¼ æ ·æœ¬ |
| **Bitdefender** | https://www.bitdefender.com/submit/ | 2-4å¤© | æä¾›æºä»£ç é“¾æ¥æœ‰åŠ©äºå®¡æ ¸ |
| **è¶‹åŠ¿ç§‘æŠ€** | https://www.trendmicro.com/en_us/about/legal/detection-reevaluation.html | 3-5å¤© | æ—¥æœ¬å…¬å¸ï¼Œæ”¯æŒä¸­æ–‡ |

#### ç”³è¯‰æ¨¡æ¿

```
Subject: False Positive Report - HEMouse Accessibility Software

Dear [Antivirus Vendor] Security Team,

I am writing to report a false positive detection of our software HEMouse.

**Product Information:**
- Name: HEMouse
- Version: 1.0.0
- File: hemouse.exe
- SHA256: [hash]
- Developer: Manshall Technology Co.
- Website: https://hemouse.example.com
- Source Code: https://github.com/manshall/hemouse

**Purpose:**
HEMouse is a legitimate accessibility tool that enables hands-free mouse
control using head movements and keyboard shortcuts. It is designed to
help users with RSI (Repetitive Strain Injury) and improve ergonomics.

**Why it uses sensitive APIs:**
- Keyboard hooks (SetWindowsHookEx): To provide keyboard-based mouse control
- UI Automation (UIA): To detect clickable elements on screen
- Overlay windows: To display hint labels for element selection

**Privacy & Security:**
- Does NOT collect or transmit user data
- Does NOT log keystrokes
- All processing is local
- Open source for transparency
- Code signed with EV certificate (DigiCert)

**Evidence:**
- GitHub repository: [link]
- Code signing certificate: Verified by DigiCert
- Privacy policy: [link]
- Microsoft false positive cleared: [if applicable]

We would greatly appreciate if you could review and whitelist our software.
Please let me know if you need any additional information.

Best regards,
[Your Name]
[Your Title]
[Contact Information]
```

### 5.3 VirusTotalæ‰«æä¸ä¿¡èª‰

#### VirusTotalæäº¤ç­–ç•¥

**å…¬å¼€æäº¤ vs ç§å¯†æäº¤**

| æ–¹å¼ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
|-----|------|------|---------|
| **å…¬å¼€æäº¤** | - å…è´¹<br>- 70+å¼•æ“æ‰«æ<br>- ç¤¾åŒºè¯„è®º | - æ–‡ä»¶å…¬å¼€ï¼ˆç«äº‰å¯¹æ‰‹å¯ä¸‹è½½ï¼‰ | å¼€æºé¡¹ç›® |
| **ç§å¯†æäº¤** | - æ–‡ä»¶ä¸å…¬å¼€<br>- APIè®¿é—® | - éœ€ä»˜è´¹($200+/æœˆ) | å•†ä¸šè½¯ä»¶ |

**ä½¿ç”¨VirusTotal**ï¼š
```bash
# 1. ä¸Šä¼ æ–‡ä»¶åˆ°VirusTotal
# ç½‘å€: https://www.virustotal.com/gui/home/upload

# 2. æŸ¥çœ‹æ‰«æç»“æœ
# ç›®æ ‡: 0/70+ æ£€å‡ºç‡

# 3. å¦‚æœæœ‰è¯¯æŠ¥ï¼Œç‚¹å‡»"Request reanalysis"
# æˆ–è”ç³»å¯¹åº”æ€æ¯’è½¯ä»¶å‚å•†

# 4. åœ¨å®˜ç½‘å±•ç¤ºæ‰«æç»“æœ
# ç¤ºä¾‹: "VirusTotal: 0/72 detections âœ…"
```

**APIè‡ªåŠ¨åŒ–æ‰«æ**ï¼ˆæŒç»­é›†æˆï¼‰
```python
# virustotal_check.py
import requests
import time

def scan_file(file_path, api_key):
    """æäº¤æ–‡ä»¶åˆ°VirusTotalæ‰«æ"""
    url = "https://www.virustotal.com/api/v3/files"
    headers = {"x-apikey": api_key}

    with open(file_path, "rb") as f:
        files = {"file": (file_path, f)}
        response = requests.post(url, headers=headers, files=files)

    if response.status_code == 200:
        scan_id = response.json()["data"]["id"]
        print(f"Scan submitted: {scan_id}")
        return scan_id
    else:
        raise Exception(f"Upload failed: {response.text}")

def get_scan_result(scan_id, api_key):
    """è·å–æ‰«æç»“æœ"""
    url = f"https://www.virustotal.com/api/v3/analyses/{scan_id}"
    headers = {"x-apikey": api_key}

    # ç­‰å¾…æ‰«æå®Œæˆ
    while True:
        response = requests.get(url, headers=headers)
        result = response.json()

        status = result["data"]["attributes"]["status"]
        if status == "completed":
            stats = result["data"]["attributes"]["stats"]
            print(f"Scan completed: {stats}")
            return stats
        else:
            print(f"Status: {status}, waiting...")
            time.sleep(30)

# ä½¿ç”¨
api_key = "YOUR_API_KEY"
scan_id = scan_file("dist/HEMouse.exe", api_key)
stats = get_scan_result(scan_id, api_key)

# æ£€æŸ¥ç»“æœ
if stats["malicious"] > 0:
    print("âŒ Detected as malicious by some engines")
    exit(1)
else:
    print("âœ… Clean scan, 0 detections")
```

### 5.4 SmartScreenä¿¡èª‰ç´¯ç§¯

#### SmartScreenå·¥ä½œåŸç†

```
æ–°æ–‡ä»¶å‘å¸ƒ â†’ SmartScreenæ— ä¿¡èª‰ â†’ "æœªçŸ¥å‘å¸ƒè€…"è­¦å‘Š
             â†“
         ç”¨æˆ·ä¸‹è½½
             â†“
         ç­¾åéªŒè¯ â†’ EVè¯ä¹¦ â†’ ç«‹å³ä¿¡èª‰ âœ…
         æˆ–         æ ‡å‡†è¯ä¹¦ â†’ éœ€ç´¯ç§¯ä¿¡èª‰
             â†“
         ä¸‹è½½é‡ > é˜ˆå€¼ï¼ˆ~1000ï¼‰â†’ ä¿¡èª‰å»ºç«‹ â†’ æ— è­¦å‘Š
```

#### åŠ é€Ÿä¿¡èª‰ç´¯ç§¯ç­–ç•¥

**1. ä½¿ç”¨EVè¯ä¹¦**ï¼ˆæœ€æœ‰æ•ˆï¼‰
- é¦–æ¬¡å‘å¸ƒå³ç»•è¿‡è­¦å‘Š
- æŠ•å…¥ï¼š$300-500/å¹´

**2. å¢åŠ ä¸‹è½½é‡**
- GitHubå‘å¸ƒï¼šå¸å¼•å¼€å‘è€…
- æŠ€æœ¯åšå®¢ï¼šåˆ†äº«ä½¿ç”¨æ¡ˆä¾‹
- ç¤¾äº¤åª’ä½“ï¼šRedditã€HackerNewsæ¨å¹¿
- ç›®æ ‡ï¼šå‰1000æ¬¡ä¸‹è½½å®¹å¿è­¦å‘Š

**3. å¤šæ¸ é“åˆ†å‘**
```
å®˜æ–¹ç½‘ç«™ä¸‹è½½
  â†“
GitHub Releases
  â†“
Microsoft Storeï¼ˆå¦‚æœå¯è¡Œï¼‰
  â†“
Chocolatey/Scoopï¼ˆåŒ…ç®¡ç†å™¨ï¼‰
```

---

## 6. Layer 4: è¡Œä¸ºé€æ˜åŒ–

### 6.1 é¦–æ¬¡è¿è¡Œæˆæƒæç¤º

#### æƒé™ç”³è¯·ç•Œé¢è®¾è®¡

```python
# permission_dialog.py
import tkinter as tk
from tkinter import messagebox

class PermissionDialog:
    def show_permission_request(self):
        """æ˜¾ç¤ºæƒé™ç”³è¯·å¯¹è¯æ¡†"""
        root = tk.Tk()
        root.withdraw()

        message = """
HEMouseéœ€è¦ä»¥ä¸‹æƒé™æ‰èƒ½æ­£å¸¸å·¥ä½œï¼š

âœ… é”®ç›˜è¾“å…¥ç›‘æ§
   ç”¨é€”ï¼šæ£€æµ‹CapsLockå’Œæ ‡ç­¾é”®ï¼ˆa-zï¼‰
   èŒƒå›´ï¼šä»…åœ¨Hintæ¨¡å¼æ¿€æ´»æ—¶
   ä¿è¯ï¼šä¸è®°å½•æˆ–ä¸Šä¼ é”®ç›˜è¾“å…¥

âœ… UIå…ƒç´ è®¿é—®
   ç”¨é€”ï¼šæ£€æµ‹å±å¹•ä¸Šçš„å¯ç‚¹å‡»å…ƒç´ 
   èŒƒå›´ï¼šä»…å½“å‰ç”¨æˆ·çš„çª—å£
   ä¿è¯ï¼šä¸è®¿é—®æ•æ„Ÿä¿¡æ¯ï¼ˆå¯†ç æ¡†é™¤å¤–ï¼‰

âœ… åˆ›å»ºé®ç½©çª—å£
   ç”¨é€”ï¼šæ˜¾ç¤ºæç¤ºæ ‡ç­¾
   èŒƒå›´ï¼šä¸´æ—¶å…¨å±é€æ˜çª—å£
   ä¿è¯ï¼šä¸æ‹¦æˆªé¼ æ ‡ç‚¹å‡»ï¼ˆå¯ç©¿é€ï¼‰

æ˜¯å¦æˆäºˆæƒé™ï¼Ÿ

éšç§å£°æ˜: https://hemouse.example.com/privacy
å¼€æºä»£ç : https://github.com/manshall/hemouse
        """

        result = messagebox.askokcancel(
            "HEMouseæƒé™ç”³è¯·",
            message,
            icon="info"
        )

        root.destroy()
        return result

# ä½¿ç”¨
if not PermissionDialog().show_permission_request():
    print("ç”¨æˆ·æ‹’ç»æƒé™ï¼Œé€€å‡ºç¨‹åº")
    exit(0)
```

### 6.2 éšç§æ”¿ç­–ï¼ˆPRIVACY.mdï¼‰

```markdown
# HEMouseéšç§æ”¿ç­–

æœ€åæ›´æ–°ï¼š2025-09-30

## æ•°æ®æ”¶é›†

**HEMouseä¸æ”¶é›†ä»»ä½•ç”¨æˆ·æ•°æ®**ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºï¼š
- âŒ é”®ç›˜è¾“å…¥è®°å½•
- âŒ é¼ æ ‡è½¨è¿¹
- âŒ è®¿é—®çš„ç½‘ç«™æˆ–åº”ç”¨ç¨‹åº
- âŒ ä¸ªäººèº«ä»½ä¿¡æ¯
- âŒ ç³»ç»Ÿä¿¡æ¯æˆ–è®¾å¤‡æ ‡è¯†

## æ•°æ®å¤„ç†

HEMouseçš„æ‰€æœ‰å¤„ç†éƒ½åœ¨**æœ¬åœ°è®¾å¤‡**ä¸Šè¿›è¡Œï¼š
- âœ… é”®ç›˜è¾“å…¥ä»…ç”¨äºæ£€æµ‹æ ‡ç­¾é”®ï¼ˆa-zï¼‰ï¼Œç«‹å³å¤„ç†åä¸¢å¼ƒ
- âœ… UIå…ƒç´ æ£€æµ‹ä»…åœ¨å†…å­˜ä¸­è¿›è¡Œï¼Œä¸æŒä¹…åŒ–
- âœ… é…ç½®æ–‡ä»¶ä»…å­˜å‚¨ç”¨æˆ·åå¥½è®¾ç½®ï¼ˆå¦‚å¿«æ·é”®ç»‘å®šï¼‰

## ç½‘ç»œé€šä¿¡

HEMouseé»˜è®¤**ä¸è¿æ¥äº’è”ç½‘**ï¼Œé™¤éï¼š
- æ£€æŸ¥æ›´æ–°ï¼ˆå¯é€‰ï¼Œç”¨æˆ·å¯ç¦ç”¨ï¼‰
- è®¿é—®GitHubä»“åº“ï¼ˆä»…ä¸‹è½½æ›´æ–°æ—¶ï¼‰

æ›´æ–°æ£€æŸ¥ä»…å‘é€ï¼š
- å½“å‰ç‰ˆæœ¬å·
- æ“ä½œç³»ç»Ÿç±»å‹ï¼ˆWindows 10/11ï¼‰

**ä¸å‘é€**ï¼šç”¨æˆ·IDã€ä½¿ç”¨ç»Ÿè®¡ã€ä¸ªäººä¿¡æ¯

## ç¬¬ä¸‰æ–¹æœåŠ¡

HEMouseä¸ä½¿ç”¨ä»»ä½•ç¬¬ä¸‰æ–¹åˆ†ææˆ–å¹¿å‘ŠæœåŠ¡ã€‚

## å¼€æºå®¡è®¡

HEMouseæ˜¯å¼€æºè½¯ä»¶ï¼Œä»»ä½•äººéƒ½å¯ä»¥å®¡è®¡ä»£ç ï¼š
https://github.com/manshall/hemouse

## è”ç³»æˆ‘ä»¬

å¦‚æœ‰éšç§é—®é¢˜ï¼Œè¯·è”ç³»ï¼šprivacy@hemouse.example.com
```

### 6.3 å®æ—¶è¡Œä¸ºæ—¥å¿—ï¼ˆå¯é€‰ï¼‰

```python
# behavior_logger.py
import logging
from datetime import datetime

class TransparentLogger:
    def __init__(self, log_dir="logs"):
        self.logger = logging.getLogger("HEMouse")
        self.logger.setLevel(logging.INFO)

        # æ–‡ä»¶æ—¥å¿—ï¼ˆä»…æœ¬åœ°ï¼Œä¸ä¸Šä¼ ï¼‰
        handler = logging.FileHandler(f"{log_dir}/hemouse.log")
        formatter = logging.Formatter(
            '%(asctime)s - %(levelname)s - %(message)s'
        )
        handler.setFormatter(formatter)
        self.logger.addHandler(handler)

    def log_mode_change(self, from_mode, to_mode):
        """è®°å½•æ¨¡å¼åˆ‡æ¢ï¼ˆä¸æ•æ„Ÿï¼‰"""
        self.logger.info(f"Mode changed: {from_mode} â†’ {to_mode}")

    def log_hook_install(self):
        """è®°å½•é’©å­å®‰è£…"""
        self.logger.info("Keyboard hook installed")

    def log_hook_uninstall(self):
        """è®°å½•é’©å­å¸è½½"""
        self.logger.info("Keyboard hook uninstalled")

    def log_element_click(self, element_type):
        """è®°å½•å…ƒç´ ç‚¹å‡»ï¼ˆä¸è®°å½•å…·ä½“å†…å®¹ï¼‰"""
        # âœ… è®°å½•ç±»å‹ï¼šButton, Link, TextBox
        self.logger.info(f"Element clicked: {element_type}")

        # âŒ ä¸è®°å½•ï¼šå…·ä½“æ–‡æœ¬ã€URLã€è¾“å…¥å†…å®¹

# ç”¨æˆ·å¯æŸ¥çœ‹æ—¥å¿—
# æä¾›"æ‰“å¼€æ—¥å¿—æ–‡ä»¶å¤¹"æŒ‰é’®
```

### 6.4 æ‰˜ç›˜å›¾æ ‡çŠ¶æ€æŒ‡ç¤º

```python
# tray_icon.py
import pystray
from PIL import Image, ImageDraw

class HEMouseTrayIcon:
    def create_icon(self, status="idle"):
        """åˆ›å»ºçŠ¶æ€å›¾æ ‡"""
        # ä¸åŒçŠ¶æ€ç”¨ä¸åŒé¢œè‰²
        colors = {
            "idle": "gray",      # ç©ºé—²ï¼šç°è‰²
            "hint": "green",     # Hintæ¨¡å¼ï¼šç»¿è‰²
            "grid": "blue",      # Gridæ¨¡å¼ï¼šè“è‰²
            "normal": "orange"   # Normalæ¨¡å¼ï¼šæ©™è‰²
        }

        color = colors.get(status, "gray")
        image = self._draw_icon(color)
        return image

    def _draw_icon(self, color):
        """ç»˜åˆ¶å›¾æ ‡"""
        img = Image.new('RGB', (64, 64), color="white")
        draw = ImageDraw.Draw(img)
        draw.ellipse([8, 8, 56, 56], fill=color)
        return img

    def show_tray_icon(self):
        """æ˜¾ç¤ºæ‰˜ç›˜å›¾æ ‡"""
        icon = pystray.Icon(
            "HEMouse",
            self.create_icon("idle"),
            "HEMouse - Idle",
            menu=pystray.Menu(
                pystray.MenuItem("æ‰“å¼€è®¾ç½®", self.open_settings),
                pystray.MenuItem("æŸ¥çœ‹æ—¥å¿—", self.open_logs),
                pystray.MenuItem("éšç§æ”¿ç­–", self.open_privacy_policy),
                pystray.MenuItem("é€€å‡º", self.quit)
            )
        )
        icon.run()

# é€æ˜åŒ–ï¼šç”¨æˆ·éšæ—¶çŸ¥é“HEMouseçš„çŠ¶æ€
```

---

## 7. ä¼ä¸šç¯å¢ƒéƒ¨ç½²ç­–ç•¥

### 7.1 ä¼ä¸šITéƒ¨é—¨çš„é¡¾è™‘

**å…¸å‹æ‹’ç»ç†ç”±**ï¼š
1. æœªçŸ¥å‘å¸ƒè€…ï¼Œæ— ä»£ç ç­¾å
2. ä½¿ç”¨æ•æ„ŸAPIï¼ˆé”®ç›˜é’©å­ï¼‰
3. ç¼ºä¹å®‰å…¨å®¡è®¡æŠ¥å‘Š
4. ä¸ç¬¦åˆä¼ä¸šå®‰å…¨ç­–ç•¥

### 7.2 ä¼ä¸šéƒ¨ç½²åŒ…ï¼ˆMSIï¼‰

```bash
# ä½¿ç”¨WiX Toolsetåˆ›å»ºMSIå®‰è£…åŒ…

# 1. å®šä¹‰äº§å“ï¼ˆProduct.wxsï¼‰
<?xml version="1.0"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Product Id="*"
           Name="HEMouse"
           Version="1.0.0"
           Manufacturer="Manshall Technology Co."
           Language="1033"
           UpgradeCode="YOUR-GUID">

    <Package InstallerVersion="200"
             Compressed="yes"
             InstallScope="perUser" />  <!-- ç”¨æˆ·çº§å®‰è£…ï¼Œä¸éœ€è¦ç®¡ç†å‘˜æƒé™ -->

    <Media Id="1" Cabinet="hemouse.cab" EmbedCab="yes" />

    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="LocalAppDataFolder">
        <Directory Id="INSTALLFOLDER" Name="HEMouse">
          <Component Id="MainExecutable" Guid="YOUR-GUID">
            <File Id="HEMouseExe"
                  Source="hemouse.exe"
                  KeyPath="yes" />
          </Component>
        </Directory>
      </Directory>
    </Directory>

    <Feature Id="Complete" Level="1">
      <ComponentRef Id="MainExecutable" />
    </Feature>

    <!-- æ•°å­—ç­¾å -->
    <SignTool Id="signtool"
              Name="signtool.exe"
              Arguments="/n 'Manshall Technology Co.' /fd SHA256 /tr http://timestamp.digicert.com /td SHA256" />

  </Product>
</Wix>

# 2. ç¼–è¯‘MSI
candle Product.wxs
light Product.wixobj -out HEMouse-1.0.0.msi

# 3. ç­¾åMSI
signtool sign /n "Manshall Technology Co." /fd SHA256 /tr http://timestamp.digicert.com /td SHA256 HEMouse-1.0.0.msi
```

### 7.3 å®‰å…¨ç™½çš®ä¹¦ï¼ˆfor ITå†³ç­–è€…ï¼‰

```markdown
# HEMouseå®‰å…¨ç™½çš®ä¹¦

**ç‰ˆæœ¬**: 1.0.0
**å‘å¸ƒæ—¥æœŸ**: 2025-09-30
**ç›®æ ‡è¯»è€…**: ä¼ä¸šITç®¡ç†å‘˜ã€å®‰å…¨å›¢é˜Ÿ

## æ‰§è¡Œæ‘˜è¦

HEMouseæ˜¯ä¸€æ¬¾å¼€æºçš„æ— éšœç¢è¾…åŠ©å·¥å…·ï¼Œä½¿ç”¨é”®ç›˜å’Œå¤´éƒ¨åŠ¨ä½œæ›¿ä»£é¼ æ ‡æ“ä½œã€‚
æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜HEMouseçš„å®‰å…¨æ¶æ„ã€éšç§ä¿æŠ¤æªæ–½å’Œä¼ä¸šéƒ¨ç½²å»ºè®®ã€‚

## æŠ€æœ¯æ¶æ„

### æƒé™éœ€æ±‚
- âœ… ç”¨æˆ·çº§é”®ç›˜é’©å­ï¼ˆWH_KEYBOARD_LLï¼‰
- âœ… Windows UIA APIè®¿é—®
- âŒ ä¸éœ€è¦ç®¡ç†å‘˜æƒé™
- âŒ ä¸éœ€è¦å†…æ ¸é©±åŠ¨

### æ•°æ®å¤„ç†
- æ‰€æœ‰å¤„ç†åœ¨æœ¬åœ°è¿›è¡Œ
- ä¸æŒä¹…åŒ–æ•æ„Ÿæ•°æ®
- ä¸è¿æ¥å¤–éƒ¨æœåŠ¡å™¨ï¼ˆé™¤æ›´æ–°æ£€æŸ¥ï¼‰

## å®‰å…¨æªæ–½

### ä»£ç ç­¾å
- EVä»£ç ç­¾åè¯ä¹¦ï¼ˆDigiCertï¼‰
- SHA256å“ˆå¸Œç®—æ³•
- æ—¶é—´æˆ³ç­¾åï¼ˆè¯ä¹¦è¿‡æœŸåä»å¯éªŒè¯ï¼‰

### å¼€æºå®¡è®¡
- GitHubå…¬å¼€æºä»£ç 
- ç¤¾åŒºå®¡è®¡å’Œè´¡çŒ®
- é€æ˜çš„å¼€å‘æµç¨‹

### éšç§ä¿æŠ¤
- éµå®ˆGDPRå’ŒCCPA
- ä¸æ”¶é›†ç”¨æˆ·æ•°æ®
- è¯¦ç»†éšç§æ”¿ç­–

## ä¼ä¸šéƒ¨ç½²

### éƒ¨ç½²æ–¹å¼
1. MSIå®‰è£…åŒ…ï¼ˆGroup Policyæ¨é€ï¼‰
2. ç”¨æˆ·çº§å®‰è£…ï¼ˆä¸éœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰
3. é™é»˜å®‰è£…æ”¯æŒï¼š`msiexec /i HEMouse.msi /quiet`

### é…ç½®ç®¡ç†
- æ³¨å†Œè¡¨é…ç½®ï¼š`HKCU\Software\HEMouse`
- å¯é€šè¿‡GPOç»Ÿä¸€é…ç½®
- æ”¯æŒä¼ä¸šé»˜è®¤è®¾ç½®

### ç›‘æ§å’Œæ—¥å¿—
- æœ¬åœ°æ—¥å¿—æ–‡ä»¶ï¼ˆå¯é…ç½®è·¯å¾„ï¼‰
- æ”¯æŒé›†ä¸­æ—¥å¿—æ”¶é›†ï¼ˆSyslogï¼‰
- æ— è¿œç¨‹é¥æµ‹

## åˆè§„æ€§

### æ ‡å‡†ç¬¦åˆ
- âœ… WCAG 2.1æ— éšœç¢æ ‡å‡†
- âœ… Windowsåº”ç”¨è®¤è¯è¦æ±‚
- âœ… GDPRæ•°æ®ä¿æŠ¤è¦æ±‚

### å®‰å…¨è®¤è¯
- Microsoft Defenderç™½åå•
- VirusTotalæ‰«ææŠ¥å‘Šï¼ˆ0æ£€å‡ºï¼‰
- ç¬¬ä¸‰æ–¹æ€æ¯’è½¯ä»¶å…¼å®¹æ€§æµ‹è¯•

## æ”¯æŒå’Œç»´æŠ¤

### æ›´æ–°æœºåˆ¶
- è‡ªåŠ¨æ›´æ–°æ£€æŸ¥ï¼ˆå¯ç¦ç”¨ï¼‰
- æ‰‹åŠ¨ä¸‹è½½å®‰è£…åŒ…
- ä¼ä¸šå†…ç½‘é•œåƒæ”¯æŒ

### æŠ€æœ¯æ”¯æŒ
- ä¼ä¸šæ”¯æŒï¼šenterprise@hemouse.example.com
- å“åº”æ—¶é—´ï¼š24å°æ—¶å†…å“åº”ï¼Œ72å°æ—¶å†…è§£å†³
- ä¸“ä¸šæœåŠ¡ï¼šå®‰å…¨å®¡è®¡ã€å®šåˆ¶å¼€å‘

## é£é™©è¯„ä¼°

### ä½é£é™©
- ç”¨æˆ·çº§æƒé™ï¼Œæ”»å‡»é¢å°
- å¼€æºé€æ˜ï¼Œå¯å®¡è®¡
- æ´»è·ƒç»´æŠ¤ï¼Œå¿«é€Ÿä¿®å¤æ¼æ´

### ç¼“è§£æªæ–½
- å®šæœŸå®‰å…¨å®¡è®¡
- æ¼æ´æŠ«éœ²è®¡åˆ’
- å¿«é€Ÿè¡¥ä¸å‘å¸ƒæµç¨‹

## æ¨èéƒ¨ç½²ç­–ç•¥

1. **è¯•ç‚¹éƒ¨ç½²**ï¼ˆ1-2å‘¨ï¼‰
   - ITéƒ¨é—¨å†…éƒ¨æµ‹è¯•
   - 10-20åç”¨æˆ·è¯•ç”¨
   - æ”¶é›†åé¦ˆå’Œç›‘æ§æ—¥å¿—

2. **å°è§„æ¨¡æ¨å¹¿**ï¼ˆ1ä¸ªæœˆï¼‰
   - ç‰¹å®šéƒ¨é—¨éƒ¨ç½²ï¼ˆå¦‚å¼€å‘å›¢é˜Ÿï¼‰
   - éªŒè¯å…¼å®¹æ€§å’Œç¨³å®šæ€§

3. **å…¨é¢æ¨å¹¿**
   - é€šè¿‡Group Policyæ¨é€
   - æä¾›åŸ¹è®­å’Œæ–‡æ¡£
   - å»ºç«‹æ”¯æŒæ¸ é“

## è”ç³»ä¿¡æ¯

- å®‰å…¨é—®é¢˜ï¼šsecurity@hemouse.example.com
- ä¼ä¸šå’¨è¯¢ï¼šenterprise@hemouse.example.com
- GitHub Issuesï¼šhttps://github.com/manshall/hemouse/issues
```

---

## 8. æŒç»­ç›‘æ§ä¸å“åº”

### 8.1 ç›‘æ§ç­–ç•¥

```python
# security_monitor.py
import requests
import time
from datetime import datetime

class SecurityMonitor:
    def __init__(self):
        self.virustotal_api_key = "YOUR_API_KEY"
        self.notification_email = "security@hemouse.example.com"

    def daily_virustotal_check(self, file_hash):
        """æ¯æ—¥æ£€æŸ¥VirusTotalçŠ¶æ€"""
        url = f"https://www.virustotal.com/api/v3/files/{file_hash}"
        headers = {"x-apikey": self.virustotal_api_key}

        response = requests.get(url, headers=headers)
        if response.status_code == 200:
            stats = response.json()["data"]["attributes"]["last_analysis_stats"]

            if stats["malicious"] > 0:
                self._alert(f"âš ï¸ New detection: {stats['malicious']} engines")

    def monitor_smartscreen_reputation(self):
        """ç›‘æ§SmartScreenä¿¡èª‰"""
        # é€šè¿‡ä¸‹è½½ç»Ÿè®¡ã€ç”¨æˆ·åé¦ˆç­‰é—´æ¥ç›‘æ§
        pass

    def _alert(self, message):
        """å‘é€è­¦æŠ¥"""
        print(f"[{datetime.now()}] {message}")
        # å‘é€é‚®ä»¶æˆ–Slacké€šçŸ¥

# éƒ¨ç½²åˆ°CI/CD
monitor = SecurityMonitor()
monitor.daily_virustotal_check("YOUR_FILE_SHA256")
```

### 8.2 æ¼æ´å“åº”æµç¨‹

```yaml
æ¼æ´å‘ç°:
  - ç”¨æˆ·æŠ¥å‘Š
  - å®‰å…¨ç ”ç©¶å‘˜æŠ«éœ²
  - è‡ªåŠ¨æ‰«ææ£€æµ‹

å“åº”æµç¨‹:
  1. ç¡®è®¤æ¼æ´ï¼ˆ24å°æ—¶å†…ï¼‰
  2. è¯„ä¼°é£é™©ç­‰çº§
  3. å¼€å‘è¡¥ä¸ï¼ˆCritical: 48h, High: 7d, Medium: 30dï¼‰
  4. å†…éƒ¨æµ‹è¯•
  5. å‘å¸ƒå®‰å…¨æ›´æ–°
  6. å…¬å¼€æŠ«éœ²ï¼ˆä¿®å¤åï¼‰

é€šçŸ¥æ¸ é“:
  - GitHub Security Advisory
  - å®˜ç½‘å…¬å‘Š
  - é‚®ä»¶é€šçŸ¥ï¼ˆä¼ä¸šç”¨æˆ·ï¼‰
  - ç¤¾äº¤åª’ä½“
```

---

## 9. æœ€ä½³å®è·µæ£€æŸ¥æ¸…å•

### 9.1 å‘å¸ƒå‰æ£€æŸ¥æ¸…å•

```markdown
## ä»£ç å±‚é¢
- [ ] ä½¿ç”¨æœ€å°æƒé™APIï¼ˆç”¨æˆ·çº§é’©å­ï¼‰
- [ ] ä¸å­˜å‚¨æ•æ„Ÿæ•°æ®
- [ ] ä»£ç å¼€æºï¼ˆGitHubå…¬å¼€ï¼‰
- [ ] é€šè¿‡é™æ€ä»£ç åˆ†æï¼ˆæ— é«˜å±æ¼æ´ï¼‰
- [ ] ç§»é™¤è°ƒè¯•ä»£ç å’Œåé—¨

## ç­¾åä¸è®¤è¯
- [ ] EVä»£ç ç­¾åè¯ä¹¦
- [ ] ç­¾åæ‰€æœ‰å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆ.exe, .dll, .msiï¼‰
- [ ] æ·»åŠ æ—¶é—´æˆ³ç­¾å
- [ ] éªŒè¯ç­¾åæœ‰æ•ˆæ€§

## å®‰å…¨æ‰«æ
- [ ] VirusTotalæ‰«æï¼ˆ0æ£€å‡ºï¼‰
- [ ] æäº¤Microsoft Defenderï¼ˆæ— è¯¯æŠ¥ï¼‰
- [ ] ä¸»æµæ€æ¯’è½¯ä»¶æµ‹è¯•ï¼ˆKaspersky, Norton, etc.ï¼‰

## æ–‡æ¡£ä¸é€æ˜åŒ–
- [ ] éšç§æ”¿ç­–ï¼ˆPRIVACY.mdï¼‰
- [ ] å®‰å…¨å£°æ˜ï¼ˆSECURITY.mdï¼‰
- [ ] é¦–æ¬¡è¿è¡Œæƒé™æç¤º
- [ ] ä¼ä¸šå®‰å…¨ç™½çš®ä¹¦

## éƒ¨ç½²
- [ ] MSIå®‰è£…åŒ…ï¼ˆç­¾åï¼‰
- [ ] è‡ªåŠ¨æ›´æ–°æœºåˆ¶ï¼ˆå¯ç¦ç”¨ï¼‰
- [ ] æ—¥å¿—å’Œç›‘æ§

## æŒç»­ç›‘æ§
- [ ] æ¯æ—¥VirusTotalæ£€æŸ¥
- [ ] SmartScreenä¿¡èª‰ç›‘æ§
- [ ] ç”¨æˆ·åé¦ˆæ”¶é›†
```

### 9.2 å¸¸è§é”™è¯¯ä¸é¿å…

| é”™è¯¯ | åæœ | æ­£ç¡®åšæ³• |
|-----|------|---------|
| **ä¸ç­¾å** | SmartScreenè­¦å‘Šï¼Œ70%ç”¨æˆ·æµå¤± | è´­ä¹°EVè¯ä¹¦ |
| **ä»£ç æ··æ·†** | å¢åŠ å¯ç–‘åº¦ï¼Œè¯¯æŠ¥ç‡â†‘ | å¼€æºé€æ˜ |
| **ä½¿ç”¨å†…æ ¸é©±åŠ¨** | æé«˜é£é™©ï¼Œæ€æ¯’è½¯ä»¶å¿…æ‹¦ | ç”¨æˆ·çº§é’©å­ |
| **å­˜å‚¨é”®ç›˜è®°å½•** | è¢«å®šæ€§ä¸ºæ¶æ„è½¯ä»¶ | ç«‹å³å¤„ç†åä¸¢å¼ƒ |
| **æ— éšç§æ”¿ç­–** | ä¿¡ä»»åº¦ä½ï¼Œä¼ä¸šæ‹’ç» | è¯¦ç»†éšç§å£°æ˜ |
| **ä¸å“åº”è¯¯æŠ¥** | æŒç»­è¢«æ‹¦æˆª | ä¸»åŠ¨ç”³è¯‰ç™½åå• |

---

## 10. æ€»ç»“ä¸å»ºè®®

### 10.1 å…³é”®æªæ–½ä¼˜å…ˆçº§

| ä¼˜å…ˆçº§ | æªæ–½ | æˆæœ¬ | æ•ˆæœ | å®æ–½éš¾åº¦ |
|-------|------|------|------|---------|
| ğŸ”´ P0 | EVä»£ç ç­¾åè¯ä¹¦ | $300-500/å¹´ | æé«˜ | ä½ |
| ğŸ”´ P0 | å¼€æºä»£ç ï¼ˆGitHubï¼‰ | å…è´¹ | é«˜ | ä½ |
| ğŸŸ¡ P1 | Microsoft Defenderç”³è¯‰ | å…è´¹ | é«˜ | ä¸­ |
| ğŸŸ¡ P1 | éšç§æ”¿ç­–+å®‰å…¨æ–‡æ¡£ | å…è´¹ | ä¸­ | ä½ |
| ğŸŸ¢ P2 | ç¬¬ä¸‰æ–¹æ€æ¯’è½¯ä»¶ç”³è¯‰ | å…è´¹ | ä¸­ | ä¸­ |
| ğŸŸ¢ P2 | VirusTotalæŒç»­ç›‘æ§ | $0-200/æœˆ | ä¸­ | ä½ |

### 10.2 å®æ–½è·¯çº¿å›¾

**Phase 1: MVPï¼ˆ1-2å‘¨ï¼‰**
- âœ… ä»£ç å¼€æºï¼ˆGitHubï¼‰
- âœ… åŸºç¡€å®‰å…¨å®ç°ï¼ˆç”¨æˆ·çº§APIï¼‰
- âœ… éšç§æ”¿ç­–æ–‡æ¡£

**Phase 2: æ­£å¼å‘å¸ƒï¼ˆ4-6å‘¨ï¼‰**
- ğŸ“¦ è´­ä¹°EVè¯ä¹¦
- ğŸ” ç­¾åæ‰€æœ‰æ–‡ä»¶
- ğŸ“ æäº¤Microsoft Defender
- ğŸ“Š VirusTotalæ‰«æ

**Phase 3: ç”Ÿæ€å»ºè®¾ï¼ˆ3-6ä¸ªæœˆï¼‰**
- ğŸ¢ ä¼ä¸šå®‰å…¨ç™½çš®ä¹¦
- ğŸ›¡ï¸ ç¬¬ä¸‰æ–¹æ€æ¯’è½¯ä»¶ç™½åå•
- ğŸ“ˆ SmartScreenä¿¡èª‰ç´¯ç§¯
- ğŸ”„ æŒç»­ç›‘æ§ä¸å“åº”

### 10.3 é¢„æœŸæ•ˆæœ

**å®æ–½å®Œæ•´æ–¹æ¡ˆå**ï¼š
- âœ… è¯¯æŠ¥ç‡é™ä½è‡³<5%
- âœ… SmartScreenæ— è­¦å‘Šï¼ˆEVè¯ä¹¦ï¼‰
- âœ… ä¸»æµæ€æ¯’è½¯ä»¶å…¼å®¹
- âœ… ä¼ä¸šITéƒ¨é—¨æ¥å—åº¦â†‘
- âœ… ç”¨æˆ·ä¿¡ä»»åº¦â†‘ï¼Œä¸‹è½½å®Œæˆç‡>90%

---

**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv1.0
**åˆ›å»ºæ—¥æœŸ**ï¼š2025-09-30
**çŠ¶æ€**ï¼šâœ… Ready for Implementation

**ä¸‹ä¸€æ­¥è¡ŒåŠ¨**ï¼š
1. å¼€å§‹ç”³è¯·EVä»£ç ç­¾åè¯ä¹¦ï¼ˆDigiCertæ¨èï¼‰
2. å®Œå–„GitHubä»“åº“ï¼ˆæ·»åŠ SECURITY.md, PRIVACY.mdï¼‰
3. å‡†å¤‡Microsoft Defenderæäº¤ææ–™